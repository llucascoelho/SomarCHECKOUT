<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Formulário Multi-Step, Checkout e Pagamento Pix</title>
  <!-- Fonte Poppins -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    /* ===================== VARIÁVEIS GLOBAIS E RESET ===================== */
    :root {
      --primary: #4162AB;
      --primary-dark: #2E5290;
      --accent: #99D1F2;
      --background-gradient: linear-gradient(135deg, #f0f4f8, #d9e2ec);
      --text-color: #000000;
      --shadow-light: rgba(0, 0, 0, 0.15);
      --shadow-medium: rgba(0, 0, 0, 0.25);
      --shadow-heavy: rgba(0, 0, 0, 0.3);
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      background: var(--background-gradient);
      font-family: "Poppins", sans-serif;
      color: var(--text-color);
      line-height: 1.6;
      -webkit-text-size-adjust: 100%;
    }
    /* ===================== CONTAINER PADRÃO (para todas as páginas) ===================== */
    .container {
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      width: 90%;
      max-width: 1200px;
      margin: 20px auto;
      padding: 20px;
    }
    
    /* ===================== ESTILOS DO FORMULÁRIO MULTI-STEP ===================== */
    .hidden { display: none; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    
    .logo-container { text-align: center; margin-bottom: 20px; }
    .logo-container img { max-width: 180px; width: 100%; height: auto; }
    .stepper { display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px; }
    .step { text-align: center; flex: 1; cursor: default; }
    .step .circle {
      position: relative; width: 30px; height: 30px; border-radius: 50%;
      background: linear-gradient(45deg, #99D1F2, #4162AB); color: #fff; font-weight: bold;
      display: flex; align-items: center; justify-content: center; margin: 0 auto 8px;
      font-size: 0.8rem; transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .step.active .circle {
      background: linear-gradient(45deg, #4162AB, #000000);
      transform: translateY(-3px);
      box-shadow: 0 8px 15px rgba(0,0,0,0.2);
    }
    .step.completed .circle::after {
      content: "\2713"; position: absolute; bottom: -5px; right: -5px;
      background-color: #28a745; color: #fff; border-radius: 50%; width: 18px; height: 18px;
      font-size: 0.8rem; display: flex; align-items: center; justify-content: center;
    }
    .connector {
      flex: 1; height: 2px; margin: 0 5px; border-radius: 3px;
      background: linear-gradient(90deg, #28a745, #4162AB); box-shadow: 0px 2px 4px rgba(0,0,0,0.1);
    }
    .form-step { display: none; animation: fadeIn 0.3s ease-in; }
    .form-step.active { display: block; }
    .form-step h2 { margin-bottom: 15px; font-size: 1.3rem; color: #4162AB; text-align: center; }
    .input-group { margin-bottom: 15px; }
    .input-group label[for="nome"] { display: block; margin-bottom: 5px; font-size: 0.95rem; color: #333; }
    .input-group input,
    .input-group select {
      width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 6px; background: #fff;
      font-size: 0.95rem; color: #4162AB; transition: border 0.3s ease, box-shadow 0.3s ease;
    }
    .input-group input:focus,
    .input-group select:focus {
      outline: none; border-color: #4162AB; box-shadow: 0 0 5px rgba(65, 98, 171, 0.5);
    }
    .row { display: flex; gap: 20px; margin-bottom: 15px; }
    .row .input-group { flex: 1; }
    .btn-container { display: flex; justify-content: space-between; align-items: center; margin-top: 20px; }
    .btn-container.single-button { justify-content: flex-end; }
    button {
      cursor: pointer; border: none; border-radius: 6px; padding: 12px 25px; font-size: 1rem;
      background: linear-gradient(45deg, #4162AB, #99D1F2); color: #fff;
      transition: background 0.3s ease, transform 0.2s ease;
    }
    button:hover { background: linear-gradient(45deg, #99D1F2, #4162AB); transform: translateY(-2px); }
    button.avancar { background: #12CC7D; font-weight: 500; }
    button.avancar:hover { background: #3D2099; }
    button.voltar {
      background: #e74c3c; border: none; border-radius: 6px;
      color: #fff; padding: 12px 25px; font-size: 1rem; font-weight: 500;
      cursor: pointer; transition: background 0.3s ease, transform 0.2s ease;
    }
    button.voltar:hover, button.voltar:active { background: #3D2099; transform: translateY(-2px); }
    #cepMessage { display: none; margin-bottom: 15px; color: #333; font-size: 0.9rem; text-align: center; }
    @media only screen and (max-width: 480px) {
      .row { flex-direction: column; gap: 10px; }
      body { font-size: 18px; }
      .form-step h2 { font-size: 1.8rem; }
      .input-group label, .input-group input, .input-group select, button { font-size: 1.1rem; }
      input[type="date"] { appearance: none; }
    }
    
    /* ===================== ESTILOS DO CHECKOUT (Contratação) E MODAL ===================== */
    .checkout-container {
      background: #fff; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      width: 90%; max-width: 1200px; margin: 20px auto; padding: 20px;
    }
    .top-bar {
      display: flex; align-items: center; justify-content: space-between;
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      color: #fff; border-radius: 8px; padding: 10px 30px;
      box-shadow: 0 4px 10px var(--shadow-medium); margin-bottom: 20px;
      transition: box-shadow 0.3s;
    }
    .person-icon { margin-right: 20px; }
    .info { flex: 1; text-align: left; }
    .info span:first-child { font-weight: bold; }
    .info span { margin-right: 10px; }
    .right-controls { display: flex; align-items: center; gap: 10px; }
    .editar-btn {
      background: #e74c3c; border: none; border-radius: 6px;
      color: #fff; padding: 12px 25px; font-size: 1rem; font-weight: 500;
      cursor: pointer; transition: background 0.3s ease, transform 0.2s ease;
    }
    .editar-btn:hover, .editar-btn:active { background: #3D2099; transform: translateY(-2px); }
    .arrow-down { width: 24px; height: 24px; cursor: pointer; transition: transform 0.3s; }
    .arrow-down.open { transform: rotate(180deg); }
    @media (max-width: 480px) {
      .right-controls .editar-btn { display: none; }
      .mobile-edit-btn-container { display: block; text-align: center; margin-top: 5px; }
    }
    @media (min-width: 481px) {
      .mobile-edit-btn-container { display: none; }
    }
    
    .modal {
      display: none; position: fixed; z-index: 1000; left: 0; top: 0;
      width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.5);
    }
    .modal-content {
      background: #fff; margin: 10% auto; padding: 20px; border-radius: 8px;
      width: 90%; max-width: 500px; position: relative;
    }
    .close {
      position: absolute; top: 10px; right: 20px; color: #aaa; font-size: 28px;
      font-weight: bold; cursor: pointer;
    }
    .close:hover { color: #000; }
    .modal-content .section {
      border-top: 1px solid #ddd; padding-top: 15px; margin-top: 15px;
    }
    .modal-content .section:first-of-type { border-top: none; padding-top: 0; margin-top: 0; }
    .modal-content h3 { margin-bottom: 10px; color: var(--primary); }
    .modal-content p { font-size: 0.95rem; color: #333; margin-bottom: 8px; }
    
    /* ===================== ITENS DO CHECKOUT ===================== */
    .content-row { display: flex; gap: 20px; margin-top: 20px; }
    .opcoes-container { flex: 1; display: flex; flex-direction: column; gap: 10px; }
    .opcao {
      background: #fff; border: 1px solid #ccc; border-radius: 8px; padding: 15px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1); transition: transform 0.3s;
    }
    .opcao:hover { transform: translateY(-2px); }
    .opcao-header { display: flex; align-items: center; justify-content: space-between; cursor: pointer; }
    .opcao-left { display: flex; align-items: center; gap: 10px; }
    .opcao-left label { font-size: 1rem; color: var(--primary); }
    .opcao-right { font-size: 1rem; color: var(--primary); text-align: right; flex-grow: 1; margin-right: 10px; }
    .opcao-toggle { cursor: pointer; }
    .opcao-toggle img { width: 20px; height: 20px; transition: transform 0.3s; }
    .opcao-toggle img.open { transform: rotate(180deg); }
    .opcao-details { margin-top: 10px; font-size: 0.9rem; color: #666; display: none; }
    .opcao-details ul { list-style: disc; margin: 10px 0 0 20px; padding: 0; }
    
    .menu-right {
      width: 320px; background: #fff; border: 1px solid #ccc; border-radius: 8px;
      padding: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    /* Tabs para alternar entre Recorrência e semestral/PIX */
    .tabs-container {
      display: flex; gap: 5px; margin-bottom: 20px; border-bottom: 1px solid #ddd;
      padding-bottom: 5px;
    }
    .tab-button {
      flex: 1; text-align: center; padding: 10px; background: #f9f9f9; border: 1px solid #ddd;
      font-weight: 500; color: var(--primary); cursor: pointer; transition: background 0.3s, transform 0.2s;
      border-radius: 6px;
    }
    .tab-button.active { background: var(--primary); color: #fff; }
    .tab-button img { width: 20px; height: 20px; vertical-align: middle; margin-right: 5px; }
    .tab-content { display: none; }
    .tab-content.active { display: block; }
    .price-section { text-align: center; }
    .price-section h3 { font-size: 1rem; color: var(--primary); margin-bottom: 10px; }
    .price-section h2 { font-size: 1.5rem; color: var(--primary); margin-bottom: 10px; }
    .pagamento {
      background: #f9f9f9; border: 1px solid #ddd; border-radius: 6px; padding: 10px;
      margin-bottom: 15px;
    }
    .pagamento h3 { font-size: 1rem; color: var(--primary); margin-bottom: 10px; }
    .pagamento p#mensalidadeText { font-size: 0.9rem; color: #333; margin-bottom: 5px; }
    .pagamento p#valorPlanoText { font-size: 0.9rem; color: #333; margin-bottom: 5px; }
    .pagamento p#extrasText,
    .pagamento p#extrasTextPix { font-size: 0.9rem; color: #333; margin-bottom: 5px; }
    .pagamento hr { border: none; border-top: 1px solid #ddd; margin: 8px 0; }
    .pagamento p#totalText,
    .pagamento p#totalTextPix { font-size: 0.9rem; }
    .terms {
      display: flex; align-items: center; gap: 5px; font-size: 0.85rem; margin-bottom: 15px; color: var(--primary);
    }
    .terms input[type="checkbox"] { transform: scale(1.1); cursor: pointer; }
    .terms a { color: var(--primary); text-decoration: underline; transition: color 0.3s; }
    .terms a:hover { color: var(--accent); }
    .contratar {
      width: 100%; background: #12CC7D; border: none; border-radius: 6px; color: #fff;
      padding: 12px; font-size: 1rem; font-weight: 500; cursor: pointer;
      transition: background 0.3s, transform 0.2s;
    }
    .contratar:hover { background: #3D2099; transform: translateY(-2px); }
    
    /* ===================== Novo Estilo para exibição do preço com desconto ===================== */
    .discount-container {
      display: inline-flex;
      align-items: baseline;
      gap: 10px;
      background: #f1f1f1;
      padding: 5px 10px;
      border-radius: 5px;
    }
    .discount-old-price {
      text-decoration: line-through;
      color: #b0b0b0;
      font-size: 1rem;
    }
    .discount-new-price {
      color: #d32f2f;
      font-size: 1.4rem;
      font-weight: bold;
    }
    
    /* ===================== BOTÃO DE FORMA DE PAGAMENTO ===================== */
    .payment-methods {
      margin: 10px 0;
    }
    .payment-methods label {
      display: block;
      font-weight: 500;
      color: var(--primary);
      margin-bottom: 5px;
    }
    .payment-methods select {
      width: 100%;
      padding: 10px;
      background: #f9f9f9;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-weight: 500;
      color: var(--primary);
      cursor: pointer;
    }
    
    @media (max-width: 768px) {
      .content-row { flex-direction: column; }
      .top-bar .info span:not(:first-child) { display: none; }
      .top-bar { padding: 5px 15px; justify-content: space-between; }
      .top-bar .info { text-align: left; flex: 1; }
      .menu-right { width: 100%; margin-top: 20px; }
      .tabs-container { flex-direction: column; }
    }
    @media (max-width: 480px) {
      .logo-container img { max-width: 150px; }
      .top-bar { padding: 5px 10px; }
      .info { font-size: 0.9rem; text-align: left; }
      .tab-button { padding: 8px; font-size: 0.9rem; }
      .price-section h2 { font-size: 1.3rem; }
      .pagamento h3 { font-size: 0.9rem; }
      .pagamento p { font-size: 0.8rem; }
    }
    
    /* ===================== ESTILOS DA PÁGINA PAGAMENTO PIX (ATUALIZADA) ===================== */
    #pagamentoPixSection .container {
      /* Já usa a classe container padrão */
    }
    #pagamentoPixSection .top-bar {
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      color: #fff;
      border-radius: 8px;
      padding: 10px 30px;
      display: flex;
      align-items: center;
      gap: 20px;
      box-shadow: 0 4px 10px var(--shadow-medium);
      margin-bottom: 20px;
      transition: box-shadow 0.3s;
    }
    #pagamentoPixSection .person-icon { width: 32px; height: 32px; }
    #pagamentoPixSection .info {
      display: flex;
      gap: 15px;
      flex: 1;
      font-size: 1rem;
      flex-wrap: wrap;
    }
    /* Removendo negrito do primeiro item (Nome) na barra de informações da página de Pagamento Pix */
    #pagamentoPixSection .info span:first-child {
      font-weight: normal;
    }
    #pagamentoPixSection .arrow-down {
      width: 24px;
      height: 24px;
      cursor: pointer;
      transition: transform 0.3s;
    }
    #pagamentoPixSection .arrow-down.open { transform: rotate(180deg); }
    #pagamentoPixSection .content-row {
      display: flex;
      gap: 20px;
      margin-top: 20px;
      align-items: flex-start;
    }
    #pagamentoPixSection .pix-payment {
      flex: 1;
      background: #f9f9f9;
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 2px 4px var(--shadow-light);
      display: flex;
      flex-direction: column;
      gap: 20px;
    }
    #pagamentoPixSection .pix-payment h2 {
      font-size: 1.3rem;
      display: flex;
      align-items: center;
      gap: 8px;
      color: var(--primary-dark);
      border-bottom: 1px solid var(--border-color);
      padding-bottom: 10px;
      margin-bottom: 10px;
    }
    #pagamentoPixSection .pix-flex { display: flex; gap: 20px; align-items: flex-start; }
    #pagamentoPixSection .pix-instructions {
      flex: 1;
      font-size: 0.95rem;
      line-height: 1.5;
      padding: 10px;
      background: #fff;
      border: 1px solid var(--border-color);
      border-radius: 8px;
    }
    #pagamentoPixSection .pix-instructions ol {
      counter-reset: step;
      list-style: none;
      padding-left: 0;
      margin-top: 10px;
    }
    #pagamentoPixSection .pix-instructions ol li {
      position: relative;
      padding-left: 40px;
      margin-bottom: 10px;
    }
    #pagamentoPixSection .pix-instructions ol li::before {
      counter-increment: step;
      content: counter(step);
      position: absolute;
      left: 0;
      top: 50%;
      transform: translateY(-50%);
      background-color: var(--primary);
      color: #fff;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 500;
    }
    #pagamentoPixSection .qr-code-container {
      flex-shrink: 0;
    }
    #pagamentoPixSection .qr-code-container img {
      width: 180px;
      height: 180px;
      object-fit: contain;
      border-radius: 8px;
      border: 4px solid #eee;
    }
    #pagamentoPixSection .copy-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
    }
    #pagamentoPixSection .copy-container input {
      width: 100%;
      max-width: 400px;
      padding: 10px;
      border-radius: 6px;
      border: 1px solid var(--border-color);
      font-size: 0.95rem;
      text-align: center;
      color: #333;
    }
    /* Botão "Copiar chave PIX" com mesmo efeito do botão "Contratar" */
    #pagamentoPixSection .copy-button {
      background: #12CC7D;
      border: none;
      border-radius: 6px;
      color: #fff;
      padding: 12px 25px;
      font-size: 1rem;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.3s, transform 0.2s;
    }
    #pagamentoPixSection .copy-button:hover {
      background: #3D2099;
      transform: translateY(-2px);
    }
    #pagamentoPixSection .summary {
      width: 350px;
      min-width: 280px;
      background: #fff;
      border: 1px solid #ccc;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    #pagamentoPixSection .summary h3 {
      font-size: 1.4rem;
      text-align: center;
      margin-bottom: 20px;
      color: var(--primary);
    }
    #pagamentoPixSection .summary-price {
      text-align: center;
      margin-bottom: 20px;
    }
    #pagamentoPixSection .summary-price h2 {
      font-size: 1.8rem;
      color: var(--primary);
      margin: 0;
    }
    #pagamentoPixSection .summary-payment {
      border: 1px solid #eee;
      border-radius: 6px;
      padding: 10px;
      background: #f9f9f9;
    }
    #pagamentoPixSection .summary-payment h4 {
      font-size: 1rem;
      color: var(--primary);
      margin-bottom: 10px;
    }
    #pagamentoPixSection .summary-payment p {
      font-size: 0.95rem;
      margin-bottom: 8px;
    }
    
    /* ===================== BOTÃO DE FORMA DE PAGAMENTO ===================== */
    .payment-methods {
      margin: 10px 0;
    }
    .payment-methods label {
      display: block;
      font-weight: 500;
      color: var(--primary);
      margin-bottom: 5px;
    }
    .payment-methods select {
      width: 100%;
      padding: 10px;
      background: #f9f9f9;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-weight: 500;
      color: var(--primary);
      cursor: pointer;
    }
    
    @media (max-width: 768px) {
      .content-row { flex-direction: column; }
      .top-bar .info span:not(:first-child) { display: none; }
      .top-bar { padding: 5px 15px; justify-content: space-between; }
      .top-bar .info { text-align: left; flex: 1; }
      .menu-right { width: 100%; margin-top: 20px; }
      .tabs-container { flex-direction: column; }
    }
    @media (max-width: 480px) {
      .logo-container img { max-width: 150px; }
      .top-bar { padding: 5px 10px; }
      .info { font-size: 0.9rem; text-align: left; }
      .tab-button { padding: 8px; font-size: 0.9rem; }
      .price-section h2 { font-size: 1.3rem; }
      .pagamento h3 { font-size: 0.9rem; }
      .pagamento p { font-size: 0.8rem; }
    }
  </style>
</head>
<body>
  <!-- Página 1: Checkout (Formulário Multi-Step) -->
  <div id="multiStepSection" class="container">
    <div class="logo-container">
      <img src="https://i.ibb.co/5Jd1vM6/Logo-somar-vertical.png" alt="Logo">
    </div>
    <div class="stepper">
      <div class="step active">
        <div class="circle">01</div>
      </div>
      <div class="connector"></div>
      <div class="step">
        <div class="circle">02</div>
      </div>
      <div class="connector"></div>
      <div class="step">
        <div class="circle">03</div>
      </div>
    </div>
    <form id="multiStepForm">
      <!-- Passo 1: Seus Dados -->
      <div class="form-step active">
        <h2>Seus Dados</h2>
        <div class="row">
          <div class="input-group">
            <label for="nome">Nome Completo</label>
            <input id="nome" name="nome" type="text" placeholder="Ex: João da Silva" required />
          </div>
          <div class="input-group">
            <label for="dataNascimento">Data de Nascimento</label>
            <input id="dataNascimento" name="dataNascimento" type="date" required />
          </div>
        </div>
        <div class="row">
          <div class="input-group">
            <label for="cpf">Número CPF</label>
            <input id="cpf" name="cpf" type="text" placeholder="Ex: XXX.XXX.XXX-XX" required />
          </div>
          <div class="input-group">
            <label for="sexo">Sexo</label>
            <select id="sexo" name="sexo" required>
              <option value="">Selecione</option>
              <option value="M">Masculino</option>
              <option value="F">Feminino</option>
              <option value="outro">Outro</option>
            </select>
          </div>
        </div>
        <!-- NOVO CAMPO: CÓDIGO DO PLANO -->
        <div class="row">
          <div class="input-group">
            <label for="idPlano">Código do Plano</label>
            <input id="idPlano" name="idPlano" type="text" placeholder="Ex: 1 (Essencial), 2 (Classico) ou 3 (Premium)" required />
          </div>
        </div>
        <div class="btn-container single-button">
          <button type="button" class="avancar" onclick="nextStep()">Avançar</button>
        </div>
      </div>
      <!-- Passo 2: Dados para Contato -->
      <div class="form-step">
        <h2>Dados para Contato</h2>
        <div class="row">
          <div class="input-group">
            <label for="email">Email</label>
            <input id="email" name="email" type="email" placeholder="Ex: exemplo@dominio.com" required />
          </div>
          <div class="input-group">
            <label for="telefone">Telefone</label>
            <input id="telefone" name="telefone" type="text" placeholder="Ex: (XX)xxxxx-xxxx" required />
          </div>
        </div>
        <div class="btn-container">
          <button type="button" class="voltar" onclick="prevStep()">Voltar</button>
          <button type="button" class="avancar" onclick="nextStep()">Avançar</button>
        </div>
      </div>
      <!-- Passo 3: Endereço -->
      <div class="form-step">
        <h2>Endereço</h2>
        <div class="input-group">
          <label for="cep">CEP</label>
          <input id="cep" name="cep" type="text" placeholder="Ex: 01001-000" required />
        </div>
        <p id="cepMessage">Buscando CEP...</p>
        <div id="enderecoFields" class="hidden">
          <div class="input-group">
            <label for="logradouro">Logradouro</label>
            <input id="logradouro" name="logradouro" type="text" readonly />
          </div>
          <div class="input-group">
            <label for="numeroEndereco">Número</label>
            <input id="numeroEndereco" name="numeroEndereco" type="text" placeholder="Ex: 123" required />
          </div>
          <div class="input-group">
            <label for="complemento">Complemento</label>
            <input id="complemento" name="complemento" type="text" placeholder="Ex: Apto 101" />
          </div>
          <div class="input-group">
            <label for="bairro">Bairro</label>
            <input id="bairro" name="bairro" type="text" readonly />
          </div>
          <div class="input-group">
            <label for="cidade">Cidade</label>
            <input id="cidade" name="cidade" type="text" readonly />
          </div>
          <div class="input-group">
            <label for="estado">Estado</label>
            <input id="estado" name="estado" type="text" readonly />
          </div>
        </div>
        <div class="btn-container">
          <button type="button" class="voltar" onclick="prevStep()">Voltar</button>
          <button type="button" class="avancar" onclick="finalizarFormulario()">Concluir</button>
        </div>
      </div>
    </form>
  </div>

  <!-- Página 2: Contratação (Checkout) -->
  <div id="checkoutSection" class="checkout-container" style="display:none;">
    <div class="logo-container">
      <img src="https://i.ibb.co/5Jd1vM6/Logo-somar-vertical.png" alt="Logo">
    </div>
    <!-- Barra de informações -->
    <div class="top-bar">
      <img src="https://img.icons8.com/ios/50/99D1F2/user--v1.png" alt="Ícone de Pessoa" class="person-icon">
      <div class="info">
        <span id="topPlano">Plano: Básico</span>
        <span id="topName">Nome: Lucas</span>
        <span id="topTelefone">Telefone: 51999562099</span>
        <span id="topEmail">Email: lucas@exemplo.com</span>
      </div>
      <div class="right-controls">
        <button type="button" class="editar-btn" onclick="voltarParaFormulario()">Editar Dados</button>
        <img src="https://img.icons8.com/ios-filled/50/ffffff/chevron-down.png" 
             alt="Seta para baixo" class="arrow-down" id="arrowIcon" onclick="toggleDetalhes()">
      </div>
    </div>
    <div class="mobile-edit-btn-container">
      <button type="button" class="voltar" onclick="voltarParaFormulario()">Editar Dados</button>
    </div>
    <div class="content-row">
      <!-- Opções -->
      <div class="opcoes-container">
        <!-- Opção fixa: Assinatura por 6 meses -->
        <div class="opcao">
          <div class="opcao-header">
            <div class="opcao-left">
              <input type="checkbox" id="opcao0" data-cost="0" checked disabled>
              <label for="opcao0">Assinatura por 6 meses</label>
            </div>
            <div class="opcao-toggle">
              <img src="https://img.icons8.com/ios-filled/24/000000/chevron-down.png" alt="Expandir">
            </div>
          </div>
          <div class="opcao-details hidden">
            <p>Esta assinatura oferece 6 meses de cobertura com benefícios exclusivos:</p>
            <ul>
              <li>Validade: 6 meses</li>
            </ul>
          </div>
        </div>
        <!-- +1 Dependente -->
        <div class="opcao">
          <div class="opcao-header">
            <div class="opcao-left">
              <input type="checkbox" id="opcao1" data-cost="35.00">
              <label for="opcao1">+1 Dependente</label>
            </div>
            <div class="opcao-right">+ R$ 35,00/Mês</div>
            <div class="opcao-toggle">
              <img src="https://img.icons8.com/ios-filled/24/000000/chevron-down.png" alt="Expandir">
            </div>
          </div>
          <div class="opcao-details hidden">
            <p>Dependentes elegíveis:</p>
            <ul>
              <li>Titular (até 65 anos)</li>
              <li>Cônjuge</li>
              <li>Filhos</li>
              <li>Pais</li>
              <li>Sogros</li>
            </ul>
          </div>
        </div>
        <!-- +4 Dependentes -->
        <div class="opcao">
          <div class="opcao-header">
            <div class="opcao-left">
              <input type="checkbox" id="opcao2" data-cost="30.00">
              <label for="opcao2">+4 Dependentes</label>
            </div>
            <div class="opcao-right">+ R$ 30,00/Mês</div>
            <div class="opcao-toggle">
              <img src="https://img.icons8.com/ios-filled/24/000000/chevron-down.png" alt="Expandir">
            </div>
          </div>
          <div class="opcao-details hidden">
            <p>Dependentes elegíveis:</p>
            <ul>
              <li>Titular (até 65 anos)</li>
              <li>Cônjuge</li>
              <li>Filhos</li>
              <li>Pais</li>
              <li>Sogros</li>
            </ul>
          </div>
        </div>
        <!-- Seguro Internação -->
        <div class="opcao">
          <div class="opcao-header">
            <div class="opcao-left">
              <input type="checkbox" id="opcao3" data-cost="40.00">
              <label for="opcao3">Seguro Internação</label>
            </div>
            <div class="opcao-right">+ R$ 40,00/Mês</div>
            <div class="opcao-toggle">
              <img src="https://img.icons8.com/ios-filled/24/000000/chevron-down.png" alt="Expandir">
            </div>
          </div>
          <div class="opcao-details hidden">
            <p>
              O benefício de Seguro Internação e Morte Acidental, oferecido pela Somar Life, estabelece condições para reembolso e cobertura em casos de internação e acidente.
            </p>
            <p><strong>Seguro Internação:</strong> Reembolso das diárias (a partir de 48h, até 5 diárias, com franquia).</p>
            <p><strong>Seguro Morte:</strong> Pagamento de R$10.000,00 aos beneficiários, exceto riscos excluídos.</p>
          </div>
        </div>
      </div>
      <!-- Menu de Pagamento -->
      <div class="menu-right">
        <div class="tabs-container">
          <button id="mensalBtn" class="tab-button active" onclick="setTab('mensal'); updatePaymentSummary();">
            <img id="mensalIcon" src="https://img.icons8.com/ios-filled/50/ffffff/bank-cards.png" alt="Recorrencia">Recorrencia
          </button>
          <button id="pixBtn" class="tab-button" onclick="setTab('pix'); updatePaymentSummary();">
            <img id="pixIcon" src="https://img.icons8.com/ios-filled/50/000000/money-bag.png" alt="semestral">semestral
          </button>
        </div>
        <div id="paymentDetails">
          <!-- Aba Recorrencia -->
          <div class="tab-content active" id="tabMensal">
            <div class="price-section">
              <h3 id="planNameTitle">Plano Básico</h3>
              <h2 id="planPrice">R$ 84,90/Mês</h2>
            </div>
            <div class="pagamento">
              <h3>Pagamento</h3>
              <p id="mensalidadeText">Mensalidade: R$ 84,90</p>
              <p id="extrasText">Extras: R$ 0,00</p>
              <hr>
              <p id="totalText"><strong>Total: R$ 84,90</strong></p>
            </div>
            <div class="payment-methods">
              <label for="paymentMethodSelectRecorrencia">Formas de pagamento:</label>
              <select id="paymentMethodSelectRecorrencia" onchange="updatePaymentSummary();">
                <option value="credito">Cartão de crédito</option>
                <option value="pix_recorrente">PIX recorrente</option>
              </select>
            </div>
            <div class="terms">
              <input type="checkbox" id="acceptTerms">
              <label for="acceptTerms">
                Li e concordo com o <a href="https://drive.google.com/file/d/1-fPh7qbHNHoc0DzuPTGUXggLBvx46lu/view?usp=sharing" target="_blank">Termos de uso</a>
                e a <a href="https://drive.google.com/file/d/16UwKRPuFjZC-EYOQfC2caRbvEJuGmUYl/view" target="_blank">Política de privacidade</a>.
              </label>
            </div>
            <button class="contratar" type="button" onclick="iniciarPagamento()">Contratar</button>
          </div>
          <!-- Aba semestral -->
          <div class="tab-content" id="tabPix">
            <div class="price-section">
              <h3 id="planNameTitlePix">Plano Básico</h3>
              <!-- Exibe o preço com desconto PIX utilizando o design do desconto -->
              <h2 id="planPriceSemestral">R$ 84,90</h2>
            </div>
            <div class="pagamento">
              <h3>Pagamento</h3>
              <p id="valorPlanoText">Valor do Plano: R$ 84,90</p>
              <p id="extrasTextPix">Extras: R$ 0,00</p>
              <hr>
              <p id="totalTextPix"><strong>Total: R$ 84,90</strong></p>
              <p id="total6mesesPix"><strong>Total 6 meses: R$ 84,90</strong></p>
            </div>
            <div class="payment-methods">
              <label for="paymentMethodSelectSemestral">Formas de pagamento:</label>
              <select id="paymentMethodSelectSemestral" onchange="updatePaymentSummary();">
                <option value="credito">Cartão de crédito</option>
                <option value="pix">PIX</option>
              </select>
            </div>
            <div class="terms">
              <input type="checkbox" id="acceptTerms2">
              <label for="acceptTerms2">
                Li e concordo com o <a href="https://drive.google.com/file/d/1-fPh7qbHNHoc0DzuPTGUXggLBvx46lu/view?usp=sharing" target="_blank">Termos de uso</a>
                e a <a href="https://drive.google.com/file/d/16UwKRPuFjZC-EYOQfC2caRbvEJuGmUYl/view" target="_blank">Política de privacidade</a>.
              </label>
            </div>
            <button class="contratar" type="button" onclick="iniciarPagamento()">Contratar</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Página 3: Pagamento Pix -->
  <div id="pagamentoPixSection" style="display:none;">
    <div class="container">
      <div class="logo-container">
        <img src="https://i.ibb.co/5Jd1vM6/Logo-somar-vertical.png" alt="Logo Somar Life">
      </div>
      <div class="top-bar">
        <img src="https://img.icons8.com/ios/50/99D1F2/user--v1.png" alt="Ícone de Pessoa" class="person-icon">
        <div class="info">
          <span id="topName">Nome: Lucas</span>
          <span>Seu Plano: Básico</span>
          <span id="topTelefone">Telefone: 51999562099</span>
          <span id="topEmail">Email: lucas@exemplo.com</span>
        </div>
        <img src="https://img.icons8.com/ios-filled/50/ffffff/chevron-down.png" alt="Seta para baixo" class="arrow-down" id="arrowIcon" onclick="toggleDetalhes()">
      </div>
      <div class="content-row">
        <div class="pix-payment">
          <h2>
            <img src="https://img.icons8.com/color/48/000000/pix.png" alt="Ícone PIX" width="24" height="24">
            Pagamento via PIX
          </h2>
          <div class="pix-flex">
            <div class="pix-instructions">
              <p>Siga estes passos para realizar o pagamento:</p>
              <ol>
                <li>Abra o app do seu banco.</li>
                <li>Selecione a opção PIX e escaneie o QR Code.</li>
                <li>Confirme o pagamento.</li>
              </ol>
            </div>
            <div class="qr-code-container">
              <img src="https://chart.googleapis.com/chart?chs=200x200&cht=qr&chl=ExemploDeChavePix" alt="QR Code de Pagamento">
            </div>
          </div>
          <div class="copy-container">
            <input type="text" id="pixKeyInput" value="00020126360014BR.GOV.BCB.PIX0114+SEU-EMAIL-OU-CHAVE+5204000053039865802BR5925NOME+EXEMPLO6009SAO PAULO62070503***6304ABCD" readonly>
            <button class="copy-button" onclick="copyPixKey()">Copiar chave PIX</button>
          </div>
        </div>
        <div class="summary">
          <h3>Resumo da contratação</h3>
          <div class="summary-price">
            <h2 id="summaryTotalValue">R$ 84,90</h2>
          </div>
          <div class="summary-payment">
            <h4>Pagamento</h4>
            <p id="mensalidadeSummary">Mensalidade: R$ 0.00</p>
            <p id="extrasSummary">Extras: R$ 0.00</p>
            <p id="totalSummary">Total: R$ 0.00</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Popup Modal para Exibir o Resumo dos Dados -->
  <div id="popupModal" class="modal hidden">
    <div class="modal-content">
      <span class="close" onclick="closePopup()">&times;</span>
      <div id="summaryContent">
        <div class="section">
          <h3>Seus Dados</h3>
          <p id="summaryNome"></p>
          <p id="summaryDataNascimento"></p>
          <p id="summaryCPF"></p>
          <p id="summarySexo"></p>
        </div>
        <div class="section">
          <h3>Dados para Contato</h3>
          <p id="summaryEmail"></p>
          <p id="summaryTelefone"></p>
        </div>
        <div class="section">
          <h3>Endereço</h3>
          <p id="summaryCEP"></p>
          <p id="summaryLogradouro"></p>
          <p id="summaryNumero"></p>
          <p id="summaryComplemento"></p>
          <p id="summaryBairro"></p>
          <p id="summaryCidade"></p>
          <p id="summaryEstado"></p>
        </div>
      </div>
    </div>
  </div>

  <script>
    /* ======= VARIÁVEIS GLOBAIS PARA OS PLANOS ======= */
    let selectedPlanPrice = 84.90; // valor padrão
    let selectedPlanName = "Básico";

    /* ======= CONFIGURAÇÃO INICIAL ======= */
    window.addEventListener("load", function() {
      const today = new Date().toISOString().split("T")[0];
      document.getElementById("dataNascimento").setAttribute("max", today);
    });

    /* ======= FORMULÁRIO MULTI-STEP ======= */
    const steps = document.querySelectorAll('.step');
    const formSteps = document.querySelectorAll('.form-step');
    let currentStep = 0;
    function updateFormSteps() {
      formSteps.forEach((formStep, index) => {
        formStep.classList.toggle('active', index === currentStep);
      });
      steps.forEach((step, index) => {
        step.classList.toggle('active', index === currentStep);
        step.classList.toggle('completed', index < currentStep);
        step.style.cursor = (index <= currentStep) ? 'pointer' : 'default';
      });
    }
    function validateStep() {
      if (currentStep === 0) {
        const fullName = document.getElementById("nome").value.trim();
        if(fullName === "" || fullName.split(/\s+/).length < 2) {
          document.getElementById("nome").setCustomValidity("Inserir nome e sobrenome");
          document.getElementById("nome").reportValidity();
          return false;
        } else {
          document.getElementById("nome").setCustomValidity("");
        }
      }
      const currentFormStep = formSteps[currentStep];
      const requiredFields = currentFormStep.querySelectorAll('input[required], select[required]');
      for (const field of requiredFields) {
        if (!field.value.trim()) {
          field.focus();
          field.reportValidity();
          return false;
        }
      }
      return true;
    }
    function nextStep() { 
      if (!validateStep()) return; 
      if (currentStep < formSteps.length - 1) { 
        currentStep++; 
        updateFormSteps(); 
      } 
    }
    function prevStep() { 
      if (currentStep > 0) { 
        currentStep--; 
        updateFormSteps(); 
      } 
    }
    function finalizarFormulario() {
      if (!validateStep()) return;
      const cpfInput = document.getElementById('cpf');
      if (!validaCPF(cpfInput.value.trim())) {
        alert('CPF inválido! Verifique antes de enviar.');
        cpfInput.focus();
        return;
      }
      // Lê o código do plano informado e define os valores correspondentes
      const idPlano = document.getElementById("idPlano").value.trim();
      let basePriceIndividual, priceDependente1, priceDependente4, planName;
      if (idPlano === "1" || idPlano.toUpperCase() === "ESSENCIAL") {
        basePriceIndividual = 35.00;
        priceDependente1 = 13.00;
        priceDependente4 = 100.00;
        planName = "Essencial";
      } else if (idPlano === "2" || idPlano.toUpperCase() === "CLASSICO") {
        basePriceIndividual = 65.00;
        priceDependente1 = 60.00;
        priceDependente4 = 230.00;
        planName = "Classico";
      } else if (idPlano === "3" || idPlano.toUpperCase() === "PREMIUM") {
        basePriceIndividual = 77.00;
        priceDependente1 = 63.00;
        priceDependente4 = 243.00;
        planName = "Premium";
      } else {
        alert("Código de Plano inválido!");
        return;
      }
      // Atualiza as variáveis globais conforme o plano selecionado
      selectedPlanPrice = basePriceIndividual;
      selectedPlanName = planName;
      // Atualiza a barra superior com o nome do plano
      document.getElementById("topPlano").textContent = "Plano: " + planName;
      // Atualiza os atributos e textos dos extras
      document.getElementById("opcao1").setAttribute("data-cost", priceDependente1.toFixed(2));
      document.getElementById("opcao2").setAttribute("data-cost", priceDependente4.toFixed(2));
      document.querySelector('#opcao1').closest('.opcao').querySelector('.opcao-right').textContent = "+ R$ " + priceDependente1.toFixed(2) + "/Mês";
      document.querySelector('#opcao2').closest('.opcao').querySelector('.opcao-right').textContent = "+ R$ " + priceDependente4.toFixed(2) + "/Mês";

      // Esconde o formulário multi-step e exibe o checkout
      document.getElementById("multiStepSection").style.display = "none";
      document.getElementById("checkoutSection").style.display = "block";
      document.getElementById("topName").textContent = "Nome: " + document.getElementById("nome").value;
      document.getElementById("topEmail").textContent = "Email: " + document.getElementById("email").value;
      document.getElementById("topTelefone").textContent = "Telefone: " + document.getElementById("telefone").value;
      updatePaymentSummary();
    }
    function voltarParaFormulario(){
      document.getElementById("checkoutSection").style.display = "none";
      document.getElementById("multiStepSection").style.display = "block";
      currentStep = 0;
      updateFormSteps();
    }

    /* ======= MÁSCARA E VALIDAÇÃO DE CPF ======= */
    function mascaraCPF(input) {
      let value = input.value.replace(/\D/g, '');
      if (value.length > 11) value = value.substring(0, 11);
      if (value.length > 9) { input.value = value.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, "$1.$2.$3-$4"); }
      else if (value.length > 6) { input.value = value.replace(/(\d{3})(\d{3})(\d{1,3})/, "$1.$2.$3"); }
      else if (value.length > 3) { input.value = value.replace(/(\d{3})(\d{1,3})/, "$1.$2"); }
      else { input.value = value; }
    }
    const cpfInput = document.getElementById('cpf');
    cpfInput.addEventListener('input', function() { mascaraCPF(this); });
    cpfInput.addEventListener('blur', function() {
      if (this.value.trim() !== '' && !validaCPF(this.value)) {
        alert('CPF inválido! Por favor, verifique e tente novamente.');
        this.value = '';
        this.style.borderColor = "#ccc";
        this.focus();
      } else if (this.value.trim() !== '' && validaCPF(this.value)) {
        this.style.borderColor = "#12CC7D";
      }
    });
    function validaCPF(cpf) {
      cpf = cpf.replace(/[^\d]+/g, '');
      if (cpf.length !== 11) return false;
      if (/^(.)\1+$/.test(cpf)) return false;
      let soma = 0;
      for (let i = 0; i < 9; i++) { soma += parseInt(cpf.charAt(i)) * (10 - i); }
      let resto = 11 - (soma % 11);
      let digito1 = (resto > 9) ? 0 : resto;
      soma = 0;
      for (let i = 0; i < 10; i++) { soma += parseInt(cpf.charAt(i)) * (11 - i); }
      resto = 11 - (soma % 11);
      let digito2 = (resto > 9) ? 0 : resto;
      return (parseInt(cpf.charAt(9)) === digito1 && parseInt(cpf.charAt(10)) === digito2);
    }

    /* ======= MÁSCARA DE TELEFONE ======= */
    function mascaraTelefone(input) {
      let value = input.value.replace(/\D/g, '');
      if (value.length > 11) value = value.substring(0, 11);
      if (value.length > 6) { input.value = value.replace(/(\d{2})(\d{5})(\d{0,4})/, "($1)$2-$3"); }
      else if (value.length > 2) { input.value = value.replace(/(\d{2})(\d{0,5})/, "($1)$2"); }
      else { input.value = value; }
    }
    const telefoneInput = document.getElementById('telefone');
    telefoneInput.addEventListener('input', function() { mascaraTelefone(this); });

    /* ======= BUSCA DE CEP (ViaCEP) ======= */
    const cepInput = document.getElementById('cep');
    const enderecoFields = document.getElementById('enderecoFields');
    const cepMessage = document.getElementById('cepMessage');
    cepInput.addEventListener('input', function() {
      let cep = cepInput.value.replace(/\D/g, '');
      if (cep.length < 8) { enderecoFields.classList.add('hidden'); cepMessage.style.display = 'none'; }
      if (cep.length === 8) { buscarCEP(); }
    });
    function buscarCEP() {
      let cep = cepInput.value.replace(/\D/g, '');
      if (cep.length !== 8) { alert('Por favor, insira um CEP válido com 8 dígitos.'); cepInput.focus(); return; }
      cepMessage.style.display = 'block';
      fetch(`https://viacep.com.br/ws/${cep}/json/`)
        .then(response => response.json())
        .then(data => {
          cepMessage.style.display = 'none';
          if (data.erro) { alert('CEP não encontrado!'); enderecoFields.classList.add('hidden'); }
          else {
            document.getElementById('logradouro').value = data.logradouro;
            document.getElementById('bairro').value = data.bairro;
            document.getElementById('cidade').value = data.localidade;
            document.getElementById('estado').value = data.uf;
            enderecoFields.classList.remove('hidden');
          }
        })
        .catch(error => { cepMessage.style.display = 'none'; alert('Erro ao buscar CEP.'); console.error(error); });
    }

    /* ======= FUNÇÕES DO CHECKOUT ======= */
    function updatePaymentSummary() {
      const basePrice = selectedPlanPrice;
      // Verifica se a aba ativa é de recorrência ou semestral
      const isRecorrencia = document.getElementById('mensalBtn').classList.contains('active');
      let extrasSum = 0;
      document.querySelectorAll('.opcoes-container input[type="checkbox"]').forEach(chk => {
        if(chk.checked && !chk.disabled){ extrasSum += parseFloat(chk.getAttribute('data-cost')); }
      });
      let total = basePrice + extrasSum;
      
      if(isRecorrencia) {
        let effectiveTotal = total;
        document.getElementById('planPrice').textContent = "R$ " + effectiveTotal.toFixed(2) + "/Mês";
        document.getElementById('mensalidadeText').textContent = "Mensalidade: R$ " + basePrice.toFixed(2);
        document.getElementById('extrasText').textContent = "Extras: R$ " + extrasSum.toFixed(2);
        document.getElementById('totalText').innerHTML = "<strong>Total: R$ " + effectiveTotal.toFixed(2) + "</strong>";
      } else {
        const paymentMethod = document.getElementById("paymentMethodSelectSemestral").value;
        let effectiveTotal = total;
        if(paymentMethod === "pix") {
          effectiveTotal = total * 0.9;
          document.getElementById('planPriceSemestral').innerHTML = 
            `<div class="discount-container">
              <span class="discount-new-price">R$ ${(effectiveTotal * 6).toFixed(2)}</span>
              <span class="discount-old-price">R$ ${(total * 6).toFixed(2)}</span>
            </div>`;
        } else {
          document.getElementById('planPriceSemestral').textContent = "R$ " + (effectiveTotal * 6).toFixed(2);
        }
        document.getElementById('valorPlanoText').textContent = "Valor do Plano: R$ " + basePrice.toFixed(2);
        document.getElementById('extrasTextPix').textContent = "Extras: R$ " + extrasSum.toFixed(2);
        document.getElementById('totalTextPix').innerHTML = "<strong>Total: R$ " + effectiveTotal.toFixed(2) + "</strong>";
        document.getElementById('total6mesesPix').innerHTML = "<strong>Total 6 meses: R$ " + (effectiveTotal * 6).toFixed(2) + "</strong>";
      }
      document.getElementById('planNameTitle').textContent = "Plano " + selectedPlanName;
      document.getElementById('planNameTitlePix').textContent = "Plano " + selectedPlanName;
      
      // Atualiza o menu de resumo da contratação com os mesmos valores do menu de pagamento
      if(document.getElementById('mensalBtn').classList.contains('active')) {
        document.getElementById('summaryTotalValue').textContent = document.getElementById('planPrice').textContent;
        document.getElementById('mensalidadeSummary').textContent = document.getElementById('mensalidadeText').textContent;
        document.getElementById('extrasSummary').textContent = document.getElementById('extrasText').textContent;
        document.getElementById('totalSummary').innerHTML = document.getElementById('totalText').innerHTML;
      } else {
        document.getElementById('summaryTotalValue').textContent = document.getElementById('planPriceSemestral').textContent;
        document.getElementById('mensalidadeSummary').textContent = document.getElementById('valorPlanoText').textContent;
        document.getElementById('extrasSummary').textContent = document.getElementById('extrasTextPix').textContent;
        document.getElementById('totalSummary').innerHTML = document.getElementById('totalTextPix').innerHTML;
      }
    }
    
    document.getElementById("paymentMethodSelectRecorrencia").addEventListener("change", updatePaymentSummary);
    document.getElementById("paymentMethodSelectSemestral").addEventListener("change", updatePaymentSummary);
    
    function setTab(tab) {
      const recorrenciaBtn = document.getElementById('mensalBtn');
      const semestralBtn = document.getElementById('pixBtn');
      const tabRecorrencia = document.getElementById('tabMensal');
      const tabSemestral = document.getElementById('tabPix');
      const recorrenciaIcon = document.getElementById('mensalIcon');
      const semestralIcon = document.getElementById('pixIcon');
      if (tab === 'mensal') {
        recorrenciaBtn.classList.add('active'); semestralBtn.classList.remove('active');
        tabRecorrencia.classList.add('active'); tabSemestral.classList.remove('active');
        recorrenciaIcon.src = "https://img.icons8.com/ios-filled/50/ffffff/bank-cards.png";
        semestralIcon.src = "https://img.icons8.com/ios-filled/50/000000/money-bag.png";
      } else {
        recorrenciaBtn.classList.remove('active'); semestralBtn.classList.add('active');
        tabRecorrencia.classList.remove('active'); tabSemestral.classList.add('active');
        recorrenciaIcon.src = "https://img.icons8.com/ios-filled/50/000000/bank-cards.png";
        semestralIcon.src = "https://img.icons8.com/ios-filled/50/ffffff/money-bag.png";
      }
      updatePaymentSummary();
    }
    
    document.querySelectorAll('.opcoes-container input[type="checkbox"]').forEach(chk => {
      chk.addEventListener('change', updatePaymentSummary);
    });
    document.querySelectorAll('.opcao-header').forEach(header => {
      header.addEventListener('click', function(e) {
        if (e.target.closest('.opcao-toggle')) return;
        const checkbox = header.querySelector('input[type="checkbox"]');
        if (!checkbox.disabled) {
          checkbox.checked = !checkbox.checked;
          if (checkbox.id === "opcao1") { document.getElementById('opcao2').checked = false; }
          if (checkbox.id === "opcao2") { document.getElementById('opcao1').checked = false; }
          updatePaymentSummary();
        }
      });
    });
    document.querySelectorAll('#opcao1, #opcao2').forEach(chk => {
      chk.addEventListener('change', function() {
        if (this.checked) {
          if (this.id === "opcao1") { document.getElementById('opcao2').checked = false; }
          if (this.id === "opcao2") { document.getElementById('opcao1').checked = false; }
          updatePaymentSummary();
        }
      });
    });
    document.querySelectorAll('.opcao-toggle').forEach(toggle => {
      toggle.addEventListener('click', function(e) {
        e.stopPropagation();
        const details = this.parentElement.parentElement.querySelector('.opcao-details');
        details.style.display = (details.style.display === 'block') ? 'none' : 'block';
        this.querySelector('img').classList.toggle('open');
      });
    });
    
    /* ======= POPUP DE RESUMO DOS DADOS ======= */
    function updateSummary() {
      document.getElementById("summaryNome").textContent = "Nome: " + document.getElementById("nome").value;
      document.getElementById("summaryDataNascimento").textContent = "Data de Nascimento: " + document.getElementById("dataNascimento").value;
      document.getElementById("summaryCPF").textContent = "CPF: " + document.getElementById("cpf").value;
      document.getElementById("summarySexo").textContent = "Sexo: " + document.getElementById("sexo").value;
      document.getElementById("summaryEmail").textContent = "Email: " + document.getElementById("email").value;
      document.getElementById("summaryTelefone").textContent = "Telefone: " + document.getElementById("telefone").value;
      document.getElementById("summaryCEP").textContent = "CEP: " + document.getElementById("cep").value;
      document.getElementById("summaryLogradouro").textContent = "Logradouro: " + document.getElementById("logradouro").value;
      document.getElementById("summaryNumero").textContent = "Número: " + document.getElementById("numeroEndereco").value;
      document.getElementById("summaryComplemento").textContent = "Complemento: " + document.getElementById("complemento").value;
      document.getElementById("summaryBairro").textContent = "Bairro: " + document.getElementById("bairro").value;
      document.getElementById("summaryCidade").textContent = "Cidade: " + document.getElementById("cidade").value;
      document.getElementById("summaryEstado").textContent = "Estado: " + document.getElementById("estado").value;
    }
    
    function toggleDetalhes() {
      const popup = document.getElementById('popupModal');
      const arrowIcon = document.getElementById('arrowIcon');
      if (popup.style.display === 'block') {
        popup.style.display = 'none';
        popup.classList.add('hidden');
        arrowIcon.classList.remove('open');
      } else {
        updateSummary();
        popup.style.display = 'block';
        popup.classList.remove('hidden');
        arrowIcon.classList.add('open');
      }
    }
    
    function closePopup() {
      const popup = document.getElementById('popupModal');
      popup.style.display = 'none';
      popup.classList.add('hidden');
      document.getElementById('arrowIcon').classList.remove('open');
    }
    
    document.querySelectorAll('.input-group input, .input-group select').forEach(input => {
      input.addEventListener('blur', function() {
        if(this.value.trim() !== "") {
          if(this.id === 'cpf'){
            this.style.borderColor = validaCPF(this.value) ? "#12CC7D" : "#e74c3c";
          } else { 
            this.style.borderColor = this.checkValidity() ? "#12CC7D" : "#ccc";
          }
        } else {
          this.style.borderColor = "#ccc";
        }
      });
    });
    document.getElementById("nome").addEventListener("blur", function() {
      const fullName = this.value.trim();
      this.setCustomValidity((fullName !== "" && fullName.split(/\s+/).length < 2) ? "Inserir nome e sobrenome" : "");
    });

    /* ======= FUNÇÕES PARA PAGAMENTO PIX (Página 3) ======= */
    function iniciarPagamento() {
      const tabAtiva = document.querySelector('.tab-content.active');
      const selectPagamento = tabAtiva.querySelector('select');
      const metodoSelecionado = selectPagamento.value;
      
      if (metodoSelecionado === "pix" || metodoSelecionado === "pix_recorrente") {
        document.getElementById("checkoutSection").style.display = "none";
        document.getElementById("pagamentoPixSection").style.display = "block";
      } else {
        alert("Processando pagamento via Cartão de Crédito");
      }
    }
    function voltarParaContratacao() {
      document.getElementById("pagamentoPixSection").style.display = "none";
      document.getElementById("checkoutSection").style.display = "block";
    }
    
    function copyPixKey() {
      const pixKeyInput = document.getElementById('pixKeyInput');
      pixKeyInput.select();
      pixKeyInput.setSelectionRange(0, 99999);
      document.execCommand('copy');
      alert('Chave PIX copiada!');
    }
  </script>

  <!-- NOVO SCRIPT: Armazenamento em Cache dos Dados do Checkout -->
  <script>
    (function(){
      // Lista de IDs dos campos do formulário multi-step
      const formFields = [
        "nome", "dataNascimento", "cpf", "sexo", "idPlano",
        "email", "telefone", "cep", "logradouro", "numeroEndereco",
        "complemento", "bairro", "cidade", "estado"
      ];

      // Ao carregar a página, preenche os campos com os dados armazenados (se houver)
      window.addEventListener("load", function() {
        formFields.forEach(function(fieldId){
          const storedValue = localStorage.getItem("checkout_" + fieldId);
          if(storedValue) {
            const field = document.getElementById(fieldId);
            if(field) {
              field.value = storedValue;
            }
          }
        });
      });

      // Adiciona um listener para armazenar o valor de cada campo sempre que ele for alterado
      formFields.forEach(function(fieldId) {
        const field = document.getElementById(fieldId);
        if(field) {
          field.addEventListener("change", function() {
            localStorage.setItem("checkout_" + fieldId, field.value);
          });
        }
      });
    })();
  </script>
</body>
</html>
